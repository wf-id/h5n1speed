{"version":"1.5.11","config":{"base":"sir_base","include":null,"custom":null},"meta":{"internal":"internal","user":"user","state":"state","result":"state_next","output":"output","time":"step","initial_time":"initial_step"},"features":{"continuous":false,"discrete":true,"mixed":false,"has_array":true,"has_output":false,"has_user":true,"has_delay":false,"has_interpolate":false,"has_stochastic":true,"has_data":false,"has_compare":false,"has_include":false,"has_debug":false,"has_derivative":false,"initial_time_dependent":false},"data":{"elements":[{"name":"beta","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_I","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_N","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_n_IR","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_n_SI","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_p_SI","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_R","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_S","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_S_inc","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dt","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"gamma","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"I","location":"variable","storage_type":"double","rank":1,"dimnames":{"length":"dim_I","dim":[],"mult":[]},"stage":"time"},{"name":"I_ini","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"initial_I","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_I","dim":[],"mult":[]},"stage":"user"},{"name":"initial_R","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_R","dim":[],"mult":[]},"stage":"user"},{"name":"initial_S","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_S","dim":[],"mult":[]},"stage":"user"},{"name":"initial_S_inc","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_S_inc","dim":[],"mult":[]},"stage":"user"},{"name":"initial_time","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"constant"},{"name":"N","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_N","dim":[],"mult":[]},"stage":"time"},{"name":"n_IR","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_n_IR","dim":[],"mult":[]},"stage":"time"},{"name":"n_SI","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_n_SI","dim":[],"mult":[]},"stage":"time"},{"name":"nsim","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"offset_variable_I","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"offset_variable_R","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"offset_variable_S_inc","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"p_IR","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"p_SI","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_p_SI","dim":[],"mult":[]},"stage":"time"},{"name":"R","location":"variable","storage_type":"double","rank":1,"dimnames":{"length":"dim_R","dim":[],"mult":[]},"stage":"time"},{"name":"S","location":"variable","storage_type":"double","rank":1,"dimnames":{"length":"dim_S","dim":[],"mult":[]},"stage":"time"},{"name":"S_inc","location":"variable","storage_type":"double","rank":1,"dimnames":{"length":"dim_S_inc","dim":[],"mult":[]},"stage":"time"},{"name":"S_ini","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"steps_per_day","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"time","location":"variable","storage_type":"double","rank":0,"dimnames":null,"stage":"time"}],"variable":{"length":["+",["+",["+",["+","dim_I","dim_R"],"dim_S"],"dim_S_inc"],1],"contents":[{"name":"time","offset":0,"initial":"initial_time"},{"name":"S","offset":1,"initial":"initial_S"},{"name":"I","offset":"offset_variable_I","initial":"initial_I"},{"name":"R","offset":"offset_variable_R","initial":"initial_R"},{"name":"S_inc","offset":"offset_variable_S_inc","initial":"initial_S_inc"}]},"output":{"length":0,"contents":[]}},"equations":[{"name":"alloc_initial_I","type":"alloc","source":[40],"depends":{"functions":[],"variables":["dim_I"]},"lhs":"initial_I"},{"name":"alloc_initial_R","type":"alloc","source":[41],"depends":{"functions":[],"variables":["dim_R"]},"lhs":"initial_R"},{"name":"alloc_initial_S","type":"alloc","source":[39],"depends":{"functions":[],"variables":["dim_S"]},"lhs":"initial_S"},{"name":"alloc_initial_S_inc","type":"alloc","source":[42],"depends":{"functions":[],"variables":["dim_S_inc"]},"lhs":"initial_S_inc"},{"name":"alloc_N","type":"alloc","source":[38],"depends":{"functions":[],"variables":["dim_N"]},"lhs":"N"},{"name":"alloc_n_IR","type":"alloc","source":[45],"depends":{"functions":[],"variables":["dim_n_IR"]},"lhs":"n_IR"},{"name":"alloc_n_SI","type":"alloc","source":[44],"depends":{"functions":[],"variables":["dim_n_SI"]},"lhs":"n_SI"},{"name":"alloc_p_SI","type":"alloc","source":[43],"depends":{"functions":[],"variables":["dim_p_SI"]},"lhs":"p_SI"},{"name":"beta","type":"user","source":[34],"depends":null,"lhs":"beta","user":{"default":0.83,"dim":false,"min":null,"max":null}},{"name":"dim_I","type":"expression_scalar","source":[40],"depends":{"functions":[],"variables":["nsim"]},"lhs":"dim_I","rhs":{"value":"nsim"}},{"name":"dim_N","type":"expression_scalar","source":[38],"depends":{"functions":[],"variables":["nsim"]},"lhs":"dim_N","rhs":{"value":"nsim"}},{"name":"dim_n_IR","type":"expression_scalar","source":[45],"depends":{"functions":[],"variables":["nsim"]},"lhs":"dim_n_IR","rhs":{"value":"nsim"}},{"name":"dim_n_SI","type":"expression_scalar","source":[44],"depends":{"functions":[],"variables":["nsim"]},"lhs":"dim_n_SI","rhs":{"value":"nsim"}},{"name":"dim_p_SI","type":"expression_scalar","source":[43],"depends":{"functions":[],"variables":["nsim"]},"lhs":"dim_p_SI","rhs":{"value":"nsim"}},{"name":"dim_R","type":"expression_scalar","source":[41],"depends":{"functions":[],"variables":["nsim"]},"lhs":"dim_R","rhs":{"value":"nsim"}},{"name":"dim_S","type":"expression_scalar","source":[39],"depends":{"functions":[],"variables":["nsim"]},"lhs":"dim_S","rhs":{"value":"nsim"}},{"name":"dim_S_inc","type":"expression_scalar","source":[42],"depends":{"functions":[],"variables":["nsim"]},"lhs":"dim_S_inc","rhs":{"value":"nsim"}},{"name":"dt","type":"expression_scalar","source":[2],"depends":{"functions":["/"],"variables":["steps_per_day"]},"lhs":"dt","rhs":{"value":["/",1,"steps_per_day"]}},{"name":"gamma","type":"user","source":[35],"depends":null,"lhs":"gamma","user":{"default":0.5,"dim":false,"min":null,"max":null}},{"name":"I_ini","type":"user","source":[33],"depends":null,"lhs":"I_ini","user":{"default":1,"dim":false,"min":null,"max":null}},{"name":"initial_I","type":"expression_array","source":[24],"depends":{"functions":["length"],"variables":["dim_I","I_ini"]},"lhs":"initial_I","rhs":[{"index":[{"value":[":",1,["length","I"]],"is_range":true,"index":"i"}],"value":"I_ini"}]},{"name":"initial_R","type":"expression_array","source":[25],"depends":{"functions":["length"],"variables":["dim_R"]},"lhs":"initial_R","rhs":[{"index":[{"value":[":",1,["length","R"]],"is_range":true,"index":"i"}],"value":0}]},{"name":"initial_S","type":"expression_array","source":[23],"depends":{"functions":["length"],"variables":["dim_S","S_ini"]},"lhs":"initial_S","rhs":[{"index":[{"value":[":",1,["length","S"]],"is_range":true,"index":"i"}],"value":"S_ini"}]},{"name":"initial_S_inc","type":"expression_array","source":[28],"depends":{"functions":["length"],"variables":["dim_S_inc"]},"lhs":"initial_S_inc","rhs":[{"index":[{"value":[":",1,["length","S_inc"]],"is_range":true,"index":"i"}],"value":0}]},{"name":"initial_time","type":"expression_scalar","source":[3],"depends":null,"lhs":"initial_time","rhs":{"value":0}},{"name":"N","type":"expression_array","source":[21],"depends":{"functions":["length","+","["],"variables":["dim_N","S","i","I","R","alloc_N"]},"lhs":"N","rhs":[{"index":[{"value":[":",1,["length","N"]],"is_range":true,"index":"i"}],"value":["+",["+",["[","S","i"],["[","I","i"]],["[","R","i"]]}]},{"name":"n_IR","type":"expression_array","source":[17],"depends":{"functions":["length","rbinom","[","*"],"variables":["dim_n_IR","I","i","p_IR","dt","alloc_n_IR"]},"lhs":"n_IR","rhs":[{"index":[{"value":[":",1,["length","n_IR"]],"is_range":true,"index":"i"}],"value":["rbinom",["[","I","i"],["*","p_IR","dt"]]}]},{"name":"n_SI","type":"expression_array","source":[16],"depends":{"functions":["length","rbinom","[","*"],"variables":["dim_n_SI","S","i","p_SI","dt","alloc_n_SI"]},"lhs":"n_SI","rhs":[{"index":[{"value":[":",1,["length","n_SI"]],"is_range":true,"index":"i"}],"value":["rbinom",["[","S","i"],["*",["[","p_SI","i"],"dt"]]}]},{"name":"nsim","type":"user","source":[37],"depends":null,"lhs":"nsim","user":{"default":500,"dim":false,"min":null,"max":null}},{"name":"offset_variable_I","type":"expression_scalar","source":[],"depends":{"functions":["+"],"variables":["dim_S"]},"lhs":"offset_variable_I","rhs":{"value":["+","dim_S",1]}},{"name":"offset_variable_R","type":"expression_scalar","source":[],"depends":{"functions":["+"],"variables":["dim_I","dim_S"]},"lhs":"offset_variable_R","rhs":{"value":["+",["+","dim_I","dim_S"],1]}},{"name":"offset_variable_S_inc","type":"expression_scalar","source":[],"depends":{"functions":["+"],"variables":["dim_I","dim_R","dim_S"]},"lhs":"offset_variable_S_inc","rhs":{"value":["+",["+",["+","dim_I","dim_R"],"dim_S"],1]}},{"name":"p_IR","type":"expression_scalar","source":[13],"depends":{"functions":["-","exp"],"variables":["gamma"]},"lhs":"p_IR","rhs":{"value":["-",1,["exp",["-","gamma"]]]}},{"name":"p_SI","type":"expression_array","source":[12],"depends":{"functions":["length","-","exp","/","*","["],"variables":["dim_p_SI","beta","I","i","N","alloc_p_SI"]},"lhs":"p_SI","rhs":[{"index":[{"value":[":",1,["length","p_SI"]],"is_range":true,"index":"i"}],"value":["-",1,["exp",["/",["*",["-","beta"],["[","I","i"]],["[","N","i"]]]]}]},{"name":"S_ini","type":"user","source":[32],"depends":null,"lhs":"S_ini","user":{"default":499,"dim":false,"min":null,"max":null}},{"name":"steps_per_day","type":"user","source":[1],"depends":null,"lhs":"steps_per_day","user":{"default":1,"dim":false,"min":null,"max":null}},{"name":"update_I","type":"expression_array","source":[8],"depends":{"functions":["length","-","+","["],"variables":["dim_I","I","i","n_SI","n_IR"]},"lhs":"I","rhs":[{"index":[{"value":[":",1,["length","I"]],"is_range":true,"index":"i"}],"value":["-",["+",["[","I","i"],["[","n_SI","i"]],["[","n_IR","i"]]}]},{"name":"update_R","type":"expression_array","source":[9],"depends":{"functions":["length","+","["],"variables":["dim_R","R","i","n_IR"]},"lhs":"R","rhs":[{"index":[{"value":[":",1,["length","R"]],"is_range":true,"index":"i"}],"value":["+",["[","R","i"],["[","n_IR","i"]]}]},{"name":"update_S","type":"expression_array","source":[7],"depends":{"functions":["length","-","["],"variables":["dim_S","S","i","n_SI"]},"lhs":"S","rhs":[{"index":[{"value":[":",1,["length","S"]],"is_range":true,"index":"i"}],"value":["-",["[","S","i"],["[","n_SI","i"]]}]},{"name":"update_S_inc","type":"expression_array","source":[29],"depends":{"functions":["length","if","==","%%","[","+"],"variables":["dim_S_inc","step","steps_per_day","n_SI","i","S_inc"]},"lhs":"S_inc","rhs":[{"index":[{"value":[":",1,["length","S_inc"]],"is_range":true,"index":"i"}],"value":["if",["==",["%%","step","steps_per_day"],0],["[","n_SI","i"],["+",["[","S_inc","i"],["[","n_SI","i"]]]}]},{"name":"update_time","type":"expression_scalar","source":[4],"depends":{"functions":["*","(","+"],"variables":["step","dt"]},"lhs":"time","rhs":{"value":["*",["(",["+","step",1]],"dt"]}}],"debug":[],"components":{"create":{"variables":[],"equations":["initial_time"]},"user":{"variables":[],"equations":["beta","gamma","I_ini","nsim","S_ini","steps_per_day","dim_I","dim_N","dim_n_IR","dim_n_SI","dim_p_SI","dim_R","dim_S","dim_S_inc","dt","p_IR","alloc_initial_I","alloc_initial_R","alloc_initial_S","alloc_initial_S_inc","alloc_N","alloc_n_IR","alloc_n_SI","alloc_p_SI","initial_I","initial_R","initial_S","initial_S_inc","offset_variable_I","offset_variable_R","offset_variable_S_inc"]},"initial":{"variables":[],"equations":[]},"rhs":{"variables":["S","I","R","S_inc"],"equations":["update_time","N","n_IR","p_SI","update_R","n_SI","update_I","update_S","update_S_inc"]},"update_stochastic":{"variables":[],"equations":[]},"output":{"variables":[],"equations":[]},"compare":{"variables":[],"equations":[]}},"user":[{"name":"beta","has_default":true},{"name":"gamma","has_default":true},{"name":"I_ini","has_default":true},{"name":"nsim","has_default":true},{"name":"S_ini","has_default":true},{"name":"steps_per_day","has_default":true}],"interpolate":{"min":[],"max":[],"critical":[]},"source":["steps_per_day <- user(1)","dt <- 1 / steps_per_day","initial(time) <- 0","update(time) <- (step + 1) * dt","","## Compartments ","update(S[]) <- S[i] - n_SI[i]","update(I[]) <- I[i] + n_SI[i] - n_IR[i]","update(R[]) <- R[i] + n_IR[i]","","## Transition probs","p_SI[] <- 1 - exp(-beta * I[i] / N[i]) # S to I","p_IR <- 1 - exp(-gamma) # I to B1","","","n_SI[] <- rbinom(S[i], p_SI[i] * dt)","n_IR[] <- rbinom(I[i], p_IR * dt)","  ","","## Total population size","N[] <- S[i] + I[i] + R[i]","","initial(S[]) <- S_ini","initial(I[]) <- I_ini","initial(R[]) <- 0","","## Convert some ÃŸvalues into incidence","initial(S_inc[]) <- 0","update(S_inc[]) <- if (step %% steps_per_day == 0) n_SI[i] else S_inc[i] + n_SI[i]","  ","## User inputs","S_ini <- user(499)","I_ini <- user(1)","beta <- user(0.83)","gamma <- user(0.5)","","nsim <- user(500)","dim(N) <- nsim","dim(S) <- nsim","dim(I) <- nsim","dim(R) <- nsim","dim(S_inc) <- nsim","dim(p_SI) <- nsim","dim(n_SI) <- nsim","dim(n_IR) <- nsim"]}
